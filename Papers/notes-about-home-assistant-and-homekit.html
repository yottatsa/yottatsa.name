<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" href="../style-v2.css"/><title>Notes about Home Assistant and HomeKit</title><meta content="text/html;charset=UTF-8" http-equiv="Content-type"/><meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="https://yottatsa.name/yadis.xrds" http-equiv="x-xrds-location"/><meta content="https://yottatsa.name/yadis.xrds" http-equiv="x-yadis-location"/></head><body class="container papers"><main class="hentry"><div class="entry-content"><h1><a href="https://yottatsa.name/Papers/notes-about-home-assistant-and-homekit.html" class="entry-title" rel="bookmark">Notes about Home Assistant and HomeKit</a></h1><address class="vcard author byline">
			<img alt="" class="photo" src="https://yottatsa.name/yottatsa.jpg"/>
			<a class="fn n" href="https://yottatsa.name/">
				<span class="given-name">Atsuko</span>
				<span class="family-name">Ito</span>
			</a><br/>
			<a class="email" href="mailto:me@yottatsa.name">me@<abbr class="nickname" title="yottatsa">yottatsa</abbr>.name</a><br/>
			<a class="url" href="https://www.linkedin.com/in/yottatsa" id="linkedin">on LinkedIn</a>
</address><time datetime="2018-04-01 00:00:00"><abbr class="published" title="2018-04-01 00:00:00">01 Apr 2018</abbr></time> <abbr class="updated" title="2020-06-12 00:26:28" datetime="2020-06-12 00:26:28"></abbr> <a rel="tag" class="category" href="https://yottatsa.name/Papers/">Papers</a>

<p class="entry-summary">Well, it's complicated. I run bunch of outdated hardware, and it is not working as smooth as I expected from Apple. So either I need to upgrade, or I have to research and hack a bit.</p>
<p>The <a href="https://www.quora.com/Does-the-Apple-TV-3rd-gen-support-HDMI-CEC-a-k-a-HDMI-Control">3rd generation of Apple TV has no CEC support</a>. So I need to read it's status to power on the TV automatically.</p>
<p>Also, the TV has Youtube app, but it couldn't switch the TV on. So it's useful to have a HomeKit Switch to turn it on, and then switch it off with Siri.</p>
<h2>My setup</h2>
<ul>
<li><em>Philips Ambilight TV 50PUS6272/05</em>. It runs webOS with jointSPACE v6, which is controlled best with both API and CEC.</li>
<li><em>Apple TV</em>, 3rd generation.</li>
<li><em>Raspberry Pi 3 B+</em>. It runs Home Assistant with <a href="https://www.home-assistant.io/components/hdmi_cec/"><code>hdmi_cec</code></a>, <a href="https://www.home-assistant.io/components/media_player.philips_js/"><code>philips_js</code></a>, <a href="https://www.home-assistant.io/components/apple_tv/"><code>apple_tv</code></a>, and <a href="https://www.home-assistant.io/components/homekit/"><code>homekit</code></a> components to automate them.</li>
<li>Lots of Apple devices. HomeKit is shared amongst a laptop and a phone, and a partner of mine.</li>
</ul>
<h2>Issues</h2>
<p><a href="https://support.apple.com/en-gb/HT207057">3rd generation of Apple TV is limited in it's HomeKit support</a>. It allows to contol HomeKit accessories remotely, but doesn't support it for shared users. It enables automatically when you log into your iCloud account on the Apple TV. However, for some reason, only Hue brigde is working over multiple devices. Home Assistant accessories are only working on a master device, other devices fails with <em>No response</em>.</p>
<p>Also, I found that Apple TV remote credentials expires every time if the iCloud is enabled on the Apple TV.</p>
<h2>Conclusion</h2>
<p>So the easiest way to make everything works stable is not to use iCloud with an old Apple TV.</p>
<p>Otherwise, it could be upgraded to the lasest generation, which is advertised with much better HomeKit support, and also supports CEC.</p></div></main></body></html>